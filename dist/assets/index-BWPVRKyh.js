(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))l(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const t of c.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&l(t)}).observe(document,{childList:!0,subtree:!0});function r(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(a){if(a.ep)return;a.ep=!0;const c=r(a);fetch(a.href,c)}})();const b="https://prod-24.southafricanorth.logic.azure.com:443/workflows/8d3e1ec3e5b649d8ba1637861dd6a2c4/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=iINQOHWvmhaSZJRMsGKhqasw4WR6bzfGGEQrZneYmpE";function g(e){const o=new Date(e),r=o.getDay(),l=o.getDate()-r,a=new Date(o.setDate(l));return a.setHours(0,0,0,0),a}function w(e){const o=[];for(let r=0;r<7;r++){const l=new Date(e);l.setDate(l.getDate()+r),o.push(l)}return o}function x(e,o){const r=new Date(e);r.setHours(0,0,0,0);const l=new Date(o);return l.setDate(o.getDate()+7),r>=o&&r<l}function D(e){const o=document.createElement("div");o.id="calendar",o.innerHTML="<h2>Week View</h2>",o.style.overflowX="auto";const r=document.createElement("table");r.id="calendar-table",r.style.minWidth="1100px",r.style.width="auto";const l=document.createElement("thead"),a=document.createElement("tr");a.innerHTML="<th>Time</th>";const c=w(e);c.forEach(d=>{a.innerHTML+=`<th>${d.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}</th>`}),l.appendChild(a),r.appendChild(l);const t=document.createElement("tbody");for(let d=7;d<=20;d++)for(let s=0;s<2;s++){const n=document.createElement("tr"),f=`${d.toString().padStart(2,"0")}:${s===0?"00":"30"}`;n.innerHTML=`<td>${f}</td>`;for(let i=0;i<7;i++)n.innerHTML+=`<td data-day="${i}" data-slot="${(d-7)*2+s}"></td>`;t.appendChild(n)}return r.appendChild(t),o.appendChild(r),document.body.appendChild(o),{weekStart:e,weekDays:c}}async function M(){try{const e=await fetch(b,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!e.ok)throw new Error("Failed to fetch meetings");const o=await e.json();return Array.isArray(o)?o.flatMap((r,l)=>Array.isArray(r.value)?r.value.map(a=>({...a,calendarIndex:l})):[]):[]}catch(e){return console.error(e),[]}}function v(e,o){document.querySelectorAll("#calendar-table td[data-day]").forEach(t=>{t.innerHTML="",t.style.display="",t.removeAttribute("rowSpan"),t.style.minWidth="",t.style.position="",t.style.verticalAlign=""});const r=["#e3f0ff","#ffe3e3","#e3ffe7","#fffbe3","#f3e3ff","#e3fff9","#ffe3f7","#e3eaff","#fbe3ff","#e3fff0","#ffe9e3","#e3fff6","#e3f7ff","#f7ffe3","#e3e3ff","#fff3e3","#e3fff3","#ffe3f0","#e3f9ff","#f0ffe3"],l=["#1976d2","#d21919","#19d26b","#bfa100","#7c19d2","#19bfae","#d2198a","#195ad2","#b819d2","#19d25a","#d26a19","#19d2b7","#199ad2","#a1d219","#6a19d2","#d2b719","#19d2a1","#d2196a","#19d2f9","#6ad219"],a=Array.from({length:7},()=>[]);e.forEach(t=>{var u,y;const d=t.startWithTimeZone||((u=t.start)==null?void 0:u.dateTime)||t.start,s=t.endWithTimeZone||((y=t.end)==null?void 0:y.dateTime)||t.end,n=new Date(d),f=new Date(s),i=(n.getDay()+7-o.getDay())%7;a[i].push({meeting:t,start:n,end:f})});const c=a.map(t=>{const d=Array(26).fill(0);return t.forEach(({start:s,end:n})=>{let f=(s.getHours()-7)*2+(s.getMinutes()>=30?1:0),i=(n.getHours()-7)*2+(n.getMinutes()>0?n.getMinutes()>30?2:1:0);n.getMinutes()===0&&n.getSeconds()===0&&(i=(n.getHours()-7)*2),n.getMinutes()===30&&n.getSeconds()===0&&(i=(n.getHours()-7)*2+1),i<=f&&(i=f+1);for(let u=f;u<i;u++)d[u]++}),Math.max(1,...d)});for(let t=0;t<7;t++){const d=document.querySelector(`#calendar-table th:nth-child(${t+2})`);d&&(d.style.minWidth=`${c[t]*120}px`);for(let s=0;s<26;s++){const n=document.querySelector(`#calendar-table td[data-day="${t}"][data-slot="${s}"]`);n&&(n.style.minWidth=`${c[t]*120}px`,n.style.position="relative",n.style.verticalAlign="top",n.style.padding="0",n.innerHTML='<div class="meeting-row" style="display:flex;position:relative;height:100%;width:100%;"></div>')}}a.forEach((t,d)=>{t.sort((s,n)=>s.start-n.start),t.forEach(({meeting:s,start:n,end:f})=>{let i=(n.getHours()-7)*2+(n.getMinutes()>=30?1:0),u=(f.getHours()-7)*2+(f.getMinutes()>0?f.getMinutes()>30?2:1:0);f.getMinutes()===0&&f.getSeconds()===0&&(u=(f.getHours()-7)*2),f.getMinutes()===30&&f.getSeconds()===0&&(u=(f.getHours()-7)*2+1),u<=i&&(u=i+1);for(let p=i+1;p<u;p++){const h=document.querySelector(`#calendar-table td[data-day="${d}"][data-slot="${p}"]`);h&&(h.style.display="none")}const y=document.querySelector(`#calendar-table td[data-day="${d}"][data-slot="${i}"]`);if(y){y.rowSpan=u-i;const p=r[s.calendarIndex%r.length],h=l[s.calendarIndex%l.length],m=y.querySelector(".meeting-row");m&&(m.innerHTML+=`<div class="meeting" style="background:${p};border-left:4px solid ${h};height:100%;min-width:100px;flex:1 1 0;max-width:${100/c[d]}%;margin:1px;box-sizing:border-box;overflow:auto;padding:2px 4px;display:flex;flex-direction:column;justify-content:center;align-items:flex-start;z-index:1;"><strong>${s.subject}</strong><br>${n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})} - ${f.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}</div>`)}})})}function L(e,o,r){const l=e.getFullYear(),a=new Date(l,o,1),c=new Date(l,o+1,0);let t=[],d=g(a);for(;d<=c;){const n=new Date(d);n.setDate(d.getDate()+6),n>=a&&d<=c&&t.push(new Date(d)),d.setDate(d.getDate()+7)}const s=document.createElement("div");return s.id="week-switcher",s.style.display="flex",s.style.justifyContent="center",s.style.alignItems="center",s.style.gap="8px",s.style.margin="16px 0 8px 0",t.forEach((n,f)=>{const i=document.createElement("button");i.textContent=`${n.toLocaleDateString(void 0,{month:"short",day:"numeric"})}`,i.style.padding="4px 10px",i.style.borderRadius="6px",i.style.border=n.getTime()===e.getTime()?"2px solid #1976d2":"1px solid #aaa",i.style.background=n.getTime()===e.getTime()?"#e3f0ff":"#fff",i.style.cursor="pointer",i.onclick=()=>r(n),s.appendChild(i)}),s}function S(){let e=document.getElementById("calendar-loader");if(e)e.style.display="flex";else{e=document.createElement("div"),e.id="calendar-loader",e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100vw",e.style.height="100vh",e.style.background="rgba(255,255,255,0.7)",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.zIndex="1000",e.innerHTML='<div style="padding:32px 48px;background:#fff;border-radius:12px;box-shadow:0 2px 16px #0002;font-size:1.3em;font-weight:bold;display:flex;align-items:center;gap:12px;"><span class="loader-spinner" style="width:24px;height:24px;border:4px solid #1976d2;border-top:4px solid #e3f0ff;border-radius:50%;display:inline-block;animation:spin 1s linear infinite;"></span>Loadingâ€¦</div>',document.body.appendChild(e);const o=document.createElement("style");o.innerHTML="@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}",document.head.appendChild(o)}}function T(){const e=document.getElementById("calendar-loader");e&&(e.style.display="none")}window.onload=async()=>{document.body.innerHTML="";const e=new Date,o=e.getMonth();let r=g(e);if(r.getMonth()!==o){const t=new Date(e.getFullYear(),o,1);r=g(t),r.getMonth()!==o&&r.setDate(r.getDate()+7)}let l=new Date(r);S();const a=await M();T();async function c(t){document.body.innerHTML="";const d=L(t,o,async n=>{l=new Date(n),await c(l)});document.body.appendChild(d),D(t);const s=a.filter(n=>{var i;const f=n.startWithTimeZone||((i=n.start)==null?void 0:i.dateTime)||n.start;return x(f,t)});v(s,t)}await c(l)};
