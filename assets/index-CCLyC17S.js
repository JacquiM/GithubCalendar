(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))d(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const t of c.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&d(t)}).observe(document,{childList:!0,subtree:!0});function s(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function d(a){if(a.ep)return;a.ep=!0;const c=s(a);fetch(a.href,c)}})();const k="https://prod-24.southafricanorth.logic.azure.com:443/workflows/8d3e1ec3e5b649d8ba1637861dd6a2c4/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=iINQOHWvmhaSZJRMsGKhqasw4WR6bzfGGEQrZneYmpE";function D(e){const o=new Date(e),s=o.getDay(),d=o.getDate()-s,a=new Date(o.setDate(d));return a.setHours(0,0,0,0),a}function A(e){const o=[];for(let s=0;s<7;s++){const d=new Date(e);d.setDate(d.getDate()+s),o.push(d)}return o}function q(e,o){const s=new Date(e);s.setHours(0,0,0,0);const d=new Date(o);return d.setDate(o.getDate()+7),s>=o&&s<d}function F(e){const o=document.createElement("div");o.id="calendar",o.innerHTML="<h2>Week View</h2>",o.style.overflowX="auto";const s=document.createElement("table");s.id="calendar-table",s.style.minWidth="1100px",s.style.width="auto";const d=document.createElement("thead"),a=document.createElement("tr");a.innerHTML="<th>Time</th>";const c=A(e);c.forEach(l=>{a.innerHTML+=`<th>${l.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}</th>`}),d.appendChild(a),s.appendChild(d);const t=document.createElement("tbody");for(let l=7;l<=20;l++)for(let i=0;i<2;i++){const n=document.createElement("tr"),p=`${l.toString().padStart(2,"0")}:${i===0?"00":"30"}`;n.innerHTML=`<td>${p}</td>`;for(let r=0;r<7;r++)n.innerHTML+=`<td data-day="${r}" data-slot="${(l-7)*2+i}"></td>`;t.appendChild(n)}return s.appendChild(t),o.appendChild(s),document.body.appendChild(o),{weekStart:e,weekDays:c}}async function P(){try{const e=await fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!e.ok)throw new Error("Failed to fetch meetings");const o=await e.json();return Array.isArray(o)?o.flatMap((s,d)=>Array.isArray(s.value)?s.value.map(a=>({...a,calendarIndex:d})):[]):[]}catch(e){return console.error(e),[]}}function j(e,o){document.querySelectorAll("#calendar-table td[data-day]").forEach(t=>{t.innerHTML="",t.style.display="",t.removeAttribute("rowSpan"),t.style.minWidth="",t.style.position="",t.style.verticalAlign=""});const s=["#e3f0ff","#ffe3e3","#e3ffe7","#fffbe3","#f3e3ff","#e3fff9","#ffe3f7","#e3eaff","#fbe3ff","#e3fff0","#ffe9e3","#e3fff6","#e3f7ff","#f7ffe3","#e3e3ff","#fff3e3","#e3fff3","#ffe3f0","#e3f9ff","#f0ffe3"],d=["#1976d2","#d21919","#19d26b","#bfa100","#7c19d2","#19bfae","#d2198a","#195ad2","#b819d2","#19d25a","#d26a19","#19d2b7","#199ad2","#a1d219","#6a19d2","#d2b719","#19d2a1","#d2196a","#19d2f9","#6ad219"],a=Array.from({length:7},()=>[]);e.forEach(t=>{var f,u;const l=t.startWithTimeZone||((f=t.start)==null?void 0:f.dateTime)||t.start,i=t.endWithTimeZone||((u=t.end)==null?void 0:u.dateTime)||t.end,n=new Date(l),p=new Date(i),r=(n.getDay()+7-o.getDay())%7;a[r].push({meeting:t,start:n,end:p})});const c=a.map(t=>{const l=Array(26).fill(0);return t.forEach(({start:i,end:n})=>{let p=(i.getHours()-7)*2+(i.getMinutes()>=30?1:0),r=(n.getHours()-7)*2+(n.getMinutes()>0?n.getMinutes()>30?2:1:0);n.getMinutes()===0&&n.getSeconds()===0&&(r=(n.getHours()-7)*2),n.getMinutes()===30&&n.getSeconds()===0&&(r=(n.getHours()-7)*2+1),r<=p&&(r=p+1);for(let f=p;f<r;f++)l[f]++}),Math.max(1,...l)});for(let t=0;t<7;t++){const l=document.querySelector(`#calendar-table th:nth-child(${t+2})`);l&&(l.style.minWidth=`${c[t]*120}px`);for(let i=0;i<26;i++){const n=document.querySelector(`#calendar-table td[data-day="${t}"][data-slot="${i}"]`);n&&(n.style.minWidth=`${c[t]*120}px`,n.style.position="relative",n.style.verticalAlign="top",n.style.padding="0",n.innerHTML='<div class="meeting-row" style="display:flex;position:relative;height:100%;width:100%;"></div>')}}a.forEach((t,l)=>{t.sort((r,f)=>r.start-f.start);let i=[],n=[],p=null;t.forEach(({meeting:r,start:f,end:u})=>{let m=(f.getHours()-7)*2+(f.getMinutes()>=30?1:0),g=(u.getHours()-7)*2+(u.getMinutes()>0?u.getMinutes()>30?2:1:0);u.getMinutes()===0&&u.getSeconds()===0&&(g=(u.getHours()-7)*2),u.getMinutes()===30&&u.getSeconds()===0&&(g=(u.getHours()-7)*2+1),g<=m&&(g=m+1),!p||m<p?(n.push({meeting:r,start:f,end:u,startSlot:m,endSlot:g}),p=Math.max(p||0,g)):(i.push(n),n=[{meeting:r,start:f,end:u,startSlot:m,endSlot:g}],p=g)}),n.length&&i.push(n),i.forEach(r=>{const f=Math.min(...r.map(h=>h.startSlot)),u=Math.max(...r.map(h=>h.endSlot));for(let h=f+1;h<u;h++){const M=document.querySelector(`#calendar-table td[data-day="${l}"][data-slot="${h}"]`);M&&(M.style.display="none")}let m=[],g=new Map;r.forEach((h,M)=>{let x=0;for(;m[x]&&m[x]>h.startSlot;)x++;m[x]=h.endSlot,g.set(M,x)});const S=Math.max(1,...Array.from(g.values()).map(h=>h+1)),w=document.querySelector(`#calendar-table td[data-day="${l}"][data-slot="${f}"]`);if(w){w.rowSpan=u-f,w.style.position="relative",w.style.padding="0",w.innerHTML='<div class="meeting-row" style="display:flex;position:relative;height:100%;width:100%;overflow-x:auto;"></div>';const h=w.querySelector(".meeting-row");setTimeout(()=>{if(h&&w.offsetHeight>0){const x=f*30+420,v=u*30+420-x,E=w.offsetHeight;r.forEach((b,H)=>{const L=s[b.meeting.calendarIndex%s.length],$=d[b.meeting.calendarIndex%d.length],C=g.get(H),T=b.start.getHours()*60+b.start.getMinutes(),O=b.end.getHours()*60+b.end.getMinutes(),W=(T-x)/v*E,I=(O-T)/v*E,y=document.createElement("div");y.className="meeting",y.style.background=L,y.style.borderLeft=`4px solid ${$}`,y.style.position="absolute",y.style.left=`${C*100/S}%`,y.style.width=`${100/S}%`,y.style.top=`${W}px`,y.style.height=`${I}px`,y.style.boxSizing="border-box",y.style.overflow="auto",y.style.padding="2px 4px",y.style.display="flex",y.style.flexDirection="column",y.style.justifyContent="center",y.style.alignItems="flex-start",y.style.zIndex="1",y.innerHTML=`<strong>${b.meeting.subject}</strong><br>${b.start.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})} - ${b.end.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`,h.appendChild(y)})}},0)}})})}function z(e,o,s){const d=e.getFullYear(),a=new Date(d,o,1),c=new Date(d,o+1,0);let t=[],l=D(a);for(;l<=c;){const n=new Date(l);n.setDate(l.getDate()+6),n>=a&&l<=c&&t.push(new Date(l)),l.setDate(l.getDate()+7)}const i=document.createElement("div");return i.id="week-switcher",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",i.style.gap="8px",i.style.margin="16px 0 8px 0",t.forEach((n,p)=>{const r=document.createElement("button");r.textContent=`${n.toLocaleDateString(void 0,{month:"short",day:"numeric"})}`,r.style.padding="4px 10px",r.style.borderRadius="6px",r.style.border=n.getTime()===e.getTime()?"2px solid #1976d2":"1px solid #aaa",r.style.background=n.getTime()===e.getTime()?"#e3f0ff":"#fff",r.style.cursor="pointer",r.onclick=()=>s(n),i.appendChild(r)}),i}function N(){let e=document.getElementById("calendar-loader");if(e)e.style.display="flex";else{e=document.createElement("div"),e.id="calendar-loader",e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100vw",e.style.height="100vh",e.style.background="rgba(255,255,255,0.7)",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.zIndex="1000",e.innerHTML='<div style="padding:32px 48px;background:#fff;border-radius:12px;box-shadow:0 2px 16px #0002;font-size:1.3em;font-weight:bold;display:flex;align-items:center;gap:12px;"><span class="loader-spinner" style="width:24px;height:24px;border:4px solid #1976d2;border-top:4px solid #e3f0ff;border-radius:50%;display:inline-block;animation:spin 1s linear infinite;"></span>Loadingâ€¦</div>',document.body.appendChild(e);const o=document.createElement("style");o.innerHTML="@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}",document.head.appendChild(o)}}function R(){const e=document.getElementById("calendar-loader");e&&(e.style.display="none")}window.onload=async()=>{document.body.innerHTML="";const e=new Date,o=e.getMonth();let s=D(e);if(s.getMonth()!==o){const t=new Date(e.getFullYear(),o,1);s=D(t),s.getMonth()!==o&&s.setDate(s.getDate()+7)}let d=new Date(s);N();const a=await P();R();async function c(t){document.body.innerHTML="";const l=z(t,o,async n=>{d=new Date(n),await c(d)});document.body.appendChild(l),F(t);const i=a.filter(n=>{var r;const p=n.startWithTimeZone||((r=n.start)==null?void 0:r.dateTime)||n.start;return q(p,t)});j(i,t)}await c(d)};
